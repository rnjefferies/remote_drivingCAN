###############################
## Mosquitto Broker for MQTT ##
###############################
RUN apt-get -y update && apt-get install -q -y --no-install-recommends \
    mosquitto \
    mosquitto-clients \
    && apt-get clean && rm -rf /var/lib/apt/lists/*
RUN sudo /etc/init.d/mosquitto stop \
    rm /etc/mosquitto/mosquitto.conf
COPY ./tod-vehicle-base/mosquitto.conf /etc/mosquitto/


To install and configure Mosquitto MQTT Broker and its clients directly on a Linux machine without using Docker, you can follow these steps. The instructions are based on Debian-based systems like Ubuntu, but the process should be similar for other Linux distributions, adjusting the package manager commands as necessary.
Step 1: Update Your System

Open a terminal and run the following command to ensure your package lists and installed packages are updated:

bash

sudo apt-get update && sudo apt-get upgrade -y

Step 2: Install Mosquitto

Install the Mosquitto broker and its client utilities:

bash

sudo apt-get install -y mosquitto mosquitto-clients

Step 3: Stop the Mosquitto Service

If you wish to modify the configuration before running the Mosquitto broker, it's a good idea to stop the service first:

bash

sudo systemctl stop mosquitto

Step 4: Configure Mosquitto

Remove the default configuration file and replace it with your custom configuration. If you already have a custom mosquitto.conf file prepared:

    Remove the existing configuration file:

    bash

sudo rm /etc/mosquitto/mosquitto.conf

Copy your custom configuration file to the /etc/mosquitto directory. Assuming your custom configuration file is located at ~/tod-vehicle-base/mosquitto.conf (adjust the path according to where your file is stored):

bash

    sudo cp ~/tod-vehicle-base/mosquitto.conf /etc/mosquitto/

If you do not have a custom configuration and just want to edit the existing one, you can skip the deletion step and directly edit the file:

bash

sudo nano /etc/mosquitto/mosquitto.conf

Add or modify the settings as needed.
Step 5: Restart and Enable the Mosquitto Service

Once your configurations are set, restart the Mosquitto service to apply the changes and enable it to start on boot:

bash

sudo systemctl restart mosquitto
sudo systemctl enable mosquitto

Step 6: Verify Mosquitto is Running

Check that Mosquitto is running correctly:

bash

sudo systemctl status mosquitto

Step 7: Test Mosquitto

To ensure that Mosquitto is functioning as expected, you can publish and subscribe to a test topic:

    Open a new terminal and subscribe to a topic:

    bash

mosquitto_sub -h localhost -t "test/topic"

In another terminal, publish a message to that topic:

bash

    mosquitto_pub -h localhost -t "test/topic" -m "Hello MQTT"

If everything is set up correctly, the message "Hello MQTT" should appear in the terminal where you subscribed.
Additional Configuration

Depending on your needs, you might want to secure your MQTT broker by setting up authentication, TLS/SSL, and other security measures. This can be done by editing the mosquitto.conf file to include the appropriate directives for enabling and configuring these features.

This set of steps will get Mosquitto installed and running on your Linux system, ready for further configuration and integration into your projects.


